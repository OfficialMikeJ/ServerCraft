
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘       ServerCraft Security Testing Suite                 â•‘
â•‘       Comprehensive Security Feature Testing             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
Testing backend at: https://servercraft-admin.preview.emergentagent.com
Started at: 2025-11-02 18:09:09



=== Test 1: Password Strength Validation ===
âŒ FAIL: Password rejection: Too short - Weak password was accepted (status: 500)
âŒ FAIL: Password rejection: No uppercase - Weak password was accepted (status: 500)
âŒ FAIL: Password rejection: No lowercase - Weak password was accepted (status: 500)
âŒ FAIL: Password rejection: No numbers - Weak password was accepted (status: 500)
âŒ FAIL: Password rejection: No special character - Weak password was accepted (status: 500)
âŒ FAIL: Password rejection: Common password - Weak password was accepted (status: 500)
âŒ FAIL: Strong password acceptance - Strong password rejected (status: 500)

=== Test 2: Rate Limiting ===
âŒ FAIL: Rate limiting enforcement - Rate limit was not enforced after 15 requests

=== Test 3: Account Lockout ===
âŒ FAIL: Account lockout after failed attempts - Account not locked (status: 500)

=== Test 4: Session Management ===
âŒ FAIL: Session management setup - Failed to create test user

=== Test 5: Token Refresh ===
âŒ FAIL: Token refresh setup - Failed to create test user

=== Test 6: Input Sanitization ===
âŒ FAIL: Input sanitization: <script>alert('XSS')</script>... - Unexpected response (status: 500)
âŒ FAIL: Input sanitization: <iframe src='evil.com'></ifram... - Unexpected response (status: 500)
âŒ FAIL: Input sanitization: '; DROP TABLE users; --... - Unexpected response (status: 500)

=== Test 7: Authentication Flows ===
âŒ FAIL: Protected endpoint without auth - Access granted without token (status: 500)
âŒ FAIL: Invalid token rejection - Invalid token accepted (status: 500)

=== Test 8: Email Validation ===
âŒ FAIL: Email validation: notanemail - Invalid email accepted (status: 500)
âŒ FAIL: Email validation: @example.com - Invalid email accepted (status: 500)
âŒ FAIL: Email validation: user@ - Invalid email accepted (status: 500)
âŒ FAIL: Email validation: user space@example.com - Invalid email accepted (status: 500)

=== Test 9: Duplicate Registration Prevention ===
âŒ FAIL: Duplicate email prevention - Duplicate allowed (status: 500)

=== Test 10: CORS Headers ===
âŒ FAIL: CORS headers present - CORS headers missing

============================================================
SECURITY TEST REPORT
============================================================
Total Tests: 22
âœ… Passed: 0
âŒ Failed: 22
Success Rate: 0.0%
============================================================

âš ï¸  FAILED TESTS:
  â€¢ Password rejection: Too short
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Password rejection: No uppercase
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Password rejection: No lowercase
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Password rejection: No numbers
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Password rejection: No special character
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Password rejection: Common password
    â””â”€ Weak password was accepted (status: 500)
  â€¢ Strong password acceptance
    â””â”€ Strong password rejected (status: 500)
  â€¢ Rate limiting enforcement
    â””â”€ Rate limit was not enforced after 15 requests
  â€¢ Account lockout after failed attempts
    â””â”€ Account not locked (status: 500)
  â€¢ Session management setup
    â””â”€ Failed to create test user
  â€¢ Token refresh setup
    â””â”€ Failed to create test user
  â€¢ Input sanitization: <script>alert('XSS')</script>...
    â””â”€ Unexpected response (status: 500)
  â€¢ Input sanitization: <iframe src='evil.com'></ifram...
    â””â”€ Unexpected response (status: 500)
  â€¢ Input sanitization: '; DROP TABLE users; --...
    â””â”€ Unexpected response (status: 500)
  â€¢ Protected endpoint without auth
    â””â”€ Access granted without token (status: 500)
  â€¢ Invalid token rejection
    â””â”€ Invalid token accepted (status: 500)
  â€¢ Email validation: notanemail
    â””â”€ Invalid email accepted (status: 500)
  â€¢ Email validation: @example.com
    â””â”€ Invalid email accepted (status: 500)
  â€¢ Email validation: user@
    â””â”€ Invalid email accepted (status: 500)
  â€¢ Email validation: user space@example.com
    â””â”€ Invalid email accepted (status: 500)
  â€¢ Duplicate email prevention
    â””â”€ Duplicate allowed (status: 500)
  â€¢ CORS headers present
    â””â”€ CORS headers missing

ğŸ“„ Detailed report saved to: /app/security_test_report.json

âš ï¸  Some tests failed. Please review and fix before deploying.
